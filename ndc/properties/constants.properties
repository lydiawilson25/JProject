NDC_DIR_PATH=/home/wstephen/Documents/IdeaProjects/FDADrugDatabase-ndc/files/
NDC_URL=http://www.fda.gov/downloads/Drugs/DevelopmentApprovalProcess/UCM070838.zip
FILE1=product.txt
SQL1=INSERT INTO INF_NDC_PRD_TMP VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15, :16, :17, :18)
FILE2=package.txt
SQL2=INSERT INTO INF_NDC_PKG_TMP VALUES (:1, :2, :3, :4)
DIFF_PRD=SELECT PRODUCT_ID,PRODUCT_NDC,PRODUCT_TYPE_NAME,PROPRIETARY_NAME,PROPRIETARY_NAME_SUFFIX,NONPROPRIETARY_NAME,DOSAGE_FORM_NAME,ROUTE_NAME,START_MARKETING_DATE,END_MARKETING_DATE,MARKETING_CATEGORY_NAME,APPL_NO,LABELER_NAME,SUBSTANCE_NAME,ACTIVE_NUMERATOR_STRENGTH,ACTIVE_INGRED_UNIT,PHARM_CLASSES,DEASCHEDULE, COUNT(ncnt) FOUND_NDC_PRODUCT_TMP, COUNT(ocnt) FOUND_NDC_PRODUCT FROM ( SELECT PRODUCT_ID,PRODUCT_NDC,PRODUCT_TYPE_NAME,PROPRIETARY_NAME,PROPRIETARY_NAME_SUFFIX,NONPROPRIETARY_NAME,DOSAGE_FORM_NAME,ROUTE_NAME,START_MARKETING_DATE,END_MARKETING_DATE,MARKETING_CATEGORY_NAME,APPL_NO,LABELER_NAME,SUBSTANCE_NAME,ACTIVE_NUMERATOR_STRENGTH,ACTIVE_INGRED_UNIT,PHARM_CLASSES,DEASCHEDULE, 1 ncnt, to_number(null) ocnt FROM INF_NDC_PRD_TMP UNION ALL SELECT PRODUCT_ID,PRODUCT_NDC,PRODUCT_TYPE_NAME,PROPRIETARY_NAME,PROPRIETARY_NAME_SUFFIX,NONPROPRIETARY_NAME,DOSAGE_FORM_NAME,ROUTE_NAME,START_MARKETING_DATE,END_MARKETING_DATE,MARKETING_CATEGORY_NAME,APPL_NO,LABELER_NAME,SUBSTANCE_NAME,ACTIVE_NUMERATOR_STRENGTH,ACTIVE_INGRED_UNIT,PHARM_CLASSES,DEASCHEDULE, to_number(null) ncnt, 2 ocnt FROM INF_NDC_PRD_CURRENT ) GROUP BY  PRODUCT_ID,PRODUCT_NDC,PRODUCT_TYPE_NAME,PROPRIETARY_NAME,PROPRIETARY_NAME_SUFFIX,NONPROPRIETARY_NAME,DOSAGE_FORM_NAME,ROUTE_NAME,START_MARKETING_DATE,END_MARKETING_DATE,MARKETING_CATEGORY_NAME,APPL_NO,LABELER_NAME,SUBSTANCE_NAME,ACTIVE_NUMERATOR_STRENGTH,ACTIVE_INGRED_UNIT,PHARM_CLASSES,DEASCHEDULE HAVING COUNT(ncnt) <> COUNT(ocnt) ORDER BY 1,2
SQL4=INSERT INTO INF_NDC_PRD_CURRENT VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15, :16, :17, :18, :19,SYSDATE, 'DRUG AUTOMATION PROCESSOR', null, null)
SQL5=UPDATE INF_NDC_PRD_CURRENT SET PRODUCT_ID=:1,PRODUCT_TYPE_NAME=:2,PROPRIETARY_NAME=:3,PROPRIETARY_NAME_SUFFIX=:4,NONPROPRIETARY_NAME=:5,DOSAGE_FORM_NAME=:6,ROUTE_NAME=:7,START_MARKETING_DATE=:8,END_MARKETING_DATE=:9,MARKETING_CATEGORY_NAME=:10,APPL_NO=:11,LABELER_NAME=:12,SUBSTANCE_NAME=:13,ACTIVE_NUMERATOR_STRENGTH=:14,ACTIVE_INGRED_UNIT=:15,PHARM_CLASSES=:16,DEASCHEDULE=:17, STATUS=:18, LAST_MODIFIED=SYSDATE, LAST_MODIFIED_BY='DRUG AUTOMATION PROCESSOR' WHERE PRODUCT_NDC=:19
SQL6=UPDATE INF_NDC_PRD_CURRENT SET STATUS='DELETE', LAST_MODIFIED=SYSDATE, LAST_MODIFIED_BY='DRUG AUTOMATION PROCESSOR' WHERE PRODUCT_ID = :1 AND PRODUCT_NDC = :2
DIFF_PKG=SELECT PRODUCT_ID,PRODUCT_NDC,NDC_PACKAGE_CODE,PACKAGE_DESCRIPTION, COUNT(ncnt) FOUND_NDC_PACKAGE_TMP, COUNT(ocnt) FOUND_NDC_PACKAGE FROM ( SELECT PRODUCT_ID,PRODUCT_NDC,NDC_PACKAGE_CODE,PACKAGE_DESCRIPTION, 1 ncnt, to_number(null) ocnt FROM INF_NDC_PKG_TMP UNION ALL SELECT PRODUCT_ID,PRODUCT_NDC,NDC_PACKAGE_CODE,PACKAGE_DESCRIPTION, to_number(null) ncnt, 2 ocnt FROM INF_NDC_PKG_CURRENT ) GROUP BY  PRODUCT_ID,PRODUCT_NDC,NDC_PACKAGE_CODE,PACKAGE_DESCRIPTION HAVING COUNT(ncnt) <> COUNT(ocnt) ORDER BY 2,3
INSERT_PKG=INSERT INTO INF_NDC_PKG_CURRENT VALUES (:1, :2, :3, :4, :5,SYSDATE, 'DRUG AUTOMATION PROCESSOR', null, null)
MARK_DELETE_PKG=UPDATE INF_NDC_PKG_CURRENT SET STATUS='DELETE' WHERE PRODUCT_ID = :1 AND NDC_PACKAGE_CODE = :2
UPDATE_PKG=UPDATE INF_NDC_PKG_CURRENT SET PRODUCT_ID=:1, PRODUCT_NDC=:2, PACKAGE_DESCRIPTION=:3, STATUS=:4, LAST_MODIFIED=SYSDATE, LAST_MODIFIED_BY='DRUG AUTOMATION PROCESSOR' WHERE NDC_PACKAGE_CODE=:5

//SQL10=SELECT DISTINCT drug_name FROM INF_FDA_PRODUCT WHERE product_mktstatus in (1,2)
//SQL11=UPDATE INF_FDA_PRODUCT SET DRUG_IN_TAXONOMY = :1, DRUG_CONCEPT_ID = :2 WHERE DRUG_NAME = :3
SQL12=SELECT APPL_NO,PRODUCT_NO,DRUG_NAME,ACTIVE_INGRED,FORM,DOSAGE,DRUG_STATUS, COUNT(ncnt) FOUND_PRODUCT_TMP, COUNT(ocnt) FOUND_PRODUCT FROM (SELECT APPL_NO,PRODUCT_NO,DRUG_NAME,ACTIVE_INGRED,FORM,DOSAGE,DRUG_STATUS, 1 ncnt, to_number(null) ocnt FROM INF_FDA_PRODUCT_TMP UNION ALL SELECT appl_no,PRODUCT_NO,DRUG_NAME,ACTIVE_INGRED,FORM,DOSAGE,DRUG_STATUS, to_number(null) ncnt, 2 ocnt FROM INF_FDA_PRODUCT_CURRENT ) GROUP BY  APPL_NO,PRODUCT_NO,DRUG_NAME,ACTIVE_INGRED,FORM,DOSAGE,DRUG_STATUS HAVING COUNT(ncnt) <> COUNT(ocnt) ORDER BY 1,2
SQL13=DELETE FROM INF_FDA_PRODUCT_TMP
SQL14=INSERT INTO INF_FDA_PRODUCT_CURRENT (APPL_NO,PRODUCT_NO,FORM,DOSAGE,DRUG_STATUS,TE_CODE,REFERENCE_DRUG,DRUG_NAME,ACTIVE_INGRED ) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9 )
SQL15=UPDATE INF_FDA_PRODUCT_CURRENT SET FORM = :1, DOSAGE = :2, DRUG_STATUS= :3, ACTIVE_INGRED = :4 WHERE APPL_NO = :5 AND PRODUCT_NO = :6
SQL16=select distinct drug_name  from inf_fda_product_current where drug_concept_id = 0 and DRUG_STATUS in ('PRESCRIPTION','OTC')
SQL17=select distinct c.concept_id, a.sty_id, b.sty_name, d.display from concept_sty a, sty b, TAXONOMY_SYN_NORM c, concept_display d where a.sty_id = b.sty_id and a.concept_id = c.concept_id and d.concept_id = c.concept_id and d.DISPLAY_TYPE_ID = 1 and b.STY_GROUP = 'drugs' and c.str_norm = :1
SQL18=update inf_fda_product_current set drug_concept_id = :1, in_taxonomy = :2 where drug_name = :3
SQL19=select distinct active_ingred from inf_fda_product_current where active_ingred_concept_id = 0 and DRUG_STATUS in ('PRESCRIPTION','OTC')
SQL20=update inf_fda_product_current set active_ingred_concept_id = :1, in_act_taxonomy = :2 where active_ingred = :3

QPE_URL=http://sfo-devqpe01:8080/qpe/api?method=AnalyzeQuery&query=
SQLDRUG=select distinct PROPRIETARY_NAME from INF_NDC_PRD_CURRENT where MARKETING_CATEGORY_NAME not like '%UNAPPROVED%' and PROPRIETARY_NAME = 'CHLORHEXIDINE GLUCONATE'
SQLDRUGUPD=UPDATE INF_NDC_PRD_CURRENT SET IN_DRUG_TAXONOMY = 'y', DRUG_CONCEPT_ID =:1 WHERE PROPRIETARY_NAME = :2

QPEACTIVE=select distinct SUBSTANCE_NAME from INF_NDC_PRD_CURRENT where MARKETING_CATEGORY_NAME not like '%UNAPPROVED%'  and SUBSTANCE_NAME is not null and SUBSTANCE_NAME like '%;%'
QPEACTIVEUPD=UPDATE INF_NDC_PRD_CURRENT SET COMBINATIONS_CONCEPT_ID =:1,IN_SUB_TAXONOMY = :2 WHERE SUBSTANCE_NAME = :3

QPEPRO=select distinct PROPRIETARY_NAME, PROPRIETARY_NAME_SUFFIX, DOSAGE_FORM_NAME, ROUTE_NAME, ACTIVE_NUMERATOR_STRENGTH, ACTIVE_INGRED_UNIT from INF_NDC_PRD_CURRENT where MARKETING_CATEGORY_NAME not like '%UNAPPROVED%'
QPEPROUPD=UPDATE INF_NDC_PRD_CURRENT SET PRODUCT_CONCEPT_ID =:1,IN_PROD_TAXONOMY = 'Y' WHERE nvl(lower(PROPRIETARY_NAME),-1) = nvl(:2,-1) and nvl(lower(PROPRIETARY_NAME_SUFFIX),-1) = nvl(:3,-1)  and nvl(lower(DOSAGE_FORM_NAME),-1) = nvl(:4,-1) and nvl(lower(ROUTE_NAME),-1) = nvl(:5,-1) and nvl(lower(ACTIVE_NUMERATOR_STRENGTH),-1) = nvl(:6,-1) and nvl(lower(ACTIVE_INGRED_UNIT),-1) = nvl(:7,-1)

SQL21=select distinct drug_name || ' ' || dosage || ' ' || form  from inf_fda_product_current where ACTIVE_INGRED_CONCEPT_ID = 0 and DRUG_STATUS in ('PRESCRIPTION','OTC')
SQL22=select c.external_concept_id from CONCEPT_MRCONSO_NORM a, MRSTY b, concept_external c where a.cui = c.external_concept_id and a.str_norm = :1 and a.cui = b.cui and b.TUI in ('T121', 'T200')
SQL23=update inf_fda_product_current set active_ingred_concept_id = :1, in_prod_taxonomy = :2 where active_ingred = :3